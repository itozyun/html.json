var r = {xml:!0, svg:!0, math:!0}, w = {async:!0, autofocus:!0, checked:!0, compact:!0, declare:!0, defer:!0, disabled:!0, draggable:!0, hidden:!0, ismap:!0, loop:!0, multiple:!0, nohref:!0, noresize:!0, noshade:!0, novalidate:!0, nowrap:!0, readonly:!0, required:!0, reversed:!0, scoped:!0, selected:!0}, y = {AREA:!0, BASE:!0, BASEFONT:!0, BR:!0, BGSOUND:!0, COL:!0, COMMAND:!0, FRAME:!0, HR:!0, IMG:!0, INPUT:!0, ISINDEX:!0, KEYGEN:!0, LINK:!0, META:!0, PARAM:!0, SOURCE:!0, TRACK:!0, EMBED:!0, WBR:!0, 
area:!0, base:!0, basefont:!0, br:!0, bgsound:!0, col:!0, command:!0, frame:!0, hr:!0, img:!0, input:!0, isindex:!0, keygen:!0, link:!0, meta:!0, param:!0, source:!0, track:!0, embed:!0, wbr:!0}, E = {CAPTION:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, 
VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DD:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, H2:!0, 
H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, 
INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DT:{ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, 
DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, P:{A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, 
RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, HTML:{HEAD:!0, BODY:!0}, HEAD:{TITLE:!0, BASE:!0, BGSOUND:!0, LINK:!0, META:!0, STYLE:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLETE:!0}, COLGROUP:{COL:!0}, OPTGROUP:{OPTION:!0}, 
OPTION:{}, TBODY:{TR:!0}, TR:{TH:!0, TD:!0}, RBC:{RB:!0, RP:!0, RT:!0}};
E.LI = E.TD = E.DD;
E.TH = E.DT;
E.RB = E.RP = E.RT = E.P;
E.TFOOT = E.THEAD = E.TBODY;
E.RTC = E.RBC;
var aa = {HTML:!0, HEAD:!0, BODY:!0, P:!0, DT:!0, DD:!0, LI:!0, OPTION:!0, TBODY:!0, THEAD:!0, TFOOT:!0, TD:!0, TH:!0, TR:!0, RB:!0, RBC:!0, RP:!0, RT:!0, RTC:!0, OPTGROUP:!0, CAPTION:!0, COLGROUP:!0}, ba = {A:!0, AUDIO:!0, DEL:!0, INS:!0, MAP:!0, NOSCRIPT:!0, VIDEO:!0}, ca = {H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, ADDRESS:!0, BLOCKQUOTE:!0, DIV:!0, DL:!0, FIELDSET:!0, FORM:!0, HR:!0, LEGEND:!0, MENU:!0, NOSCRIPT:!0, OL:!0, P:!0, PRE:!0, UL:!0, CENTER:!0, DIR:!0, NOFRAMES:!0, MARQUEE:!0}, da = 
{SCRIPT:!0, STYLE:!0, TEXTAREA:!0, TITLE:!0, PLAINTEXT:!0, XMP:!0, script:!0, style:!0, textarea:!0, title:!0, plaintext:!0, xmp:!0};
function J(a) {
  return !(!a || a.pop !== [].pop);
}
function L(a) {
  return !(!a || "object" !== typeof a);
}
function M(a) {
  return "" + a === a;
}
function N(a) {
  if (M(a) || a === +a) {
    a = 3;
  } else {
    if (J(a)) {
      if (M(a[0])) {
        a = 1;
      } else {
        var b = a[0];
        a = b === +b ? a[0] : -1;
      }
    } else {
      a = -1;
    }
  }
  return a;
}
function ea(a, b, c, h) {
  var e = b[1], d = b.slice(2), f;
  "function" === typeof a ? f = d.length ? a(e, d) : a(e) : f = d.length ? a[e].apply(null, d) : a[e]();
  void 0 !== f && null !== f && "" !== f && (M(f) || f === +f ? c ? c.splice(h, 1, f) : (b.length = 0, b.push(3, b)) : J(f) && (11 === f[0] ? c ? (f.shift(), f.unshift(h, 1), c.splice.apply(c, f)) : (b.length = 0, b.push.apply(b, f)) : J(f[0]) ? c ? (f.unshift(h, 1), c.splice.apply(c, f)) : (b.length = 0, b.push(11), b.push.apply(b, f)) : c ? c.splice(h, 1, f) : (b.length = 0, b.push(11, f))));
  return f;
}
function O(a, b, c, h) {
  var e;
  if (J(c) && M(c[0])) {
    var d = c[0];
    c = c.slice(1);
    "function" === typeof a ? e = c.length ? a(d, c) : a(d) : e = c.length ? a[d](c) : a[d]();
  } else {
    M(c) && ("function" === typeof a ? e = a(c) : e = a[c]());
  }
  return J(e) ? O(a, b, e, h) : e;
}
function fa(a, b, c) {
  a = ha(a);
  var h;
  P = a;
  b && (b.h ? b.h.push(a) : b.h = [a]);
  if (J(c)) {
    var e = 1 === a.m || 17 === a.m;
    b = 0;
    for (h = c.length; b < h; b += 2) {
      var d = c[b];
      var f = c[b + 1];
      if (d === +d) {
        if (d === a.m && !0 === f(a)) {
          break;
        }
      } else if (e && M(d) && d === a.D && !0 === f(a)) {
        break;
      }
    }
  } else {
    c(a);
  }
  return a;
}
function Q(a) {
  return a.split("&lt;").join("&amp;lt;").split("&gt;").join("&amp;gt;").split("<").join("&lt;").split(">").join("&gt;");
}
function R(a, b, c) {
  a = Q("" + a);
  var h = a.match('"'), e = a.match("'"), d = b ? "'" : '"';
  h && e ? a = b ? d + a.split("'").join("\\'") + d : d + a.split('"').join('\\"') + d : h ? a = "'" + a + "'" : e ? a = b ? d + a.split("'").join("\\'") + d : d + a + d : c || a.match(/[^0-9a-z\.\-]/g) || 72 < a.length ? a = d + a + d : "" === a && (a = d + d);
  return a;
}
function ia(a) {
  var b = a.indexOf("#"), c = a.indexOf("."), h = "", e = "";
  b < c ? (h = a.split(".")[1], a = a.split(".")[0], 0 < b && (e = a.split("#")[1], a = a.split("#")[0])) : c < b && (e = a.split("#")[1], a = a.split("#")[0], 0 < c && (h = a.split(".")[1], a = a.split(".")[0]));
  return [a, e, h];
}
function ha(a) {
  return function(b, c) {
    function h(u, F, I) {
      if (e) {
        var B = e;
        S <= T(B) ? (B.v = B.v || [], B.v.push([u, F, I]), u = null) : u = new U(B, B.h && B.h.length, u, F);
      } else {
        u = new U(!0, 0, u, F);
      }
      return u;
    }
    var e = c === !!c ? null : c;
    c = b[0];
    var d = b[1], f = 1, z = c;
    switch(c) {
      case 3:
      case 4:
      case 8:
      case 14:
      case 18:
        return h(c, d);
      case 15:
        return h(c);
      case 7:
        var v = [];
        f = 2;
        for (z = b.length; f < z; ++f) {
          v[f - 2] = b[f];
        }
        return h(c, d, z ? v : null);
      case 9:
      case 13:
      case 16:
        v = h(c, d);
        break;
      case 11:
        v = h(c);
        break;
      case 1:
      case 17:
        z = d, f = 2;
      default:
        M(z) && (v = h(1 === f ? 1 : c, z, b[f]));
    }
    return v;
  }(a, !0);
}
;function U(a, b, c, h) {
  if (a === !!a) {
    var e = null;
    this.l = a;
  } else {
    e = a, this.l = e.l;
  }
  this.j = e;
  this.m = c;
  e && (e.h || (e.h = []), a = e.h, 0 <= b && b < a.length ? a.splice(b, 0, this) : a.push(this));
  switch(c) {
    case 1:
    case 17:
    case 18:
      this.D = h;
  }
}
var P = null;
function T(a) {
  return a.l ? P === a ? a.C ? ja : a.F ? S : ka : P.j === a ? la : ma : na;
}
U.prototype.remove = function() {
  if (S <= T(this)) {
    return this.C = !0, null;
  }
  var a = this.j ? this.j.h.indexOf(this) : -1;
  0 <= a && (this.j.h.splice(a, 1), this.j = null);
};
U.prototype.wrap = function(a, b, c) {
  if (this.l) {
    this.o = this.o || [], this.o.push([a, b, c]), a = null;
  } else {
    if (this.j) {
      var h = (c = this.j) ? this.j.h.indexOf(this) : -1;
      a = new U(c, h, a, b);
    } else {
      a = null;
    }
  }
  Y(a, 0, [this]);
  return a;
};
function Y(a, b, c) {
  var h = a.h = a.h || [], e = h.length, d = c.length;
  for (b = b < e ? b : e; d;) {
    e = c[--d], 11 === e.m ? e.h && e.h.length && Y(a, b, e.h) : (e.remove(), h.splice(b, 0, e), e.j = a);
  }
}
var na = 0, ma = 1, ka = 2, S = 3, ja = 4, la = 5;
function Z(a, b, c, h, e) {
  function d(l, C, g, x, k, m) {
    function p() {
      var V = "";
      D && (V = "</" + (A ? D : D.toLowerCase()) + ">", D = "");
      return V;
    }
    var q = u ? fa(l, g, u) : null;
    g = "";
    var K = l[0], t = l[1], G = 1, n = K, H;
    switch(K) {
      case 9:
        g = t + f(l, q, !1, m);
        break;
      case 11:
        g = f(l, q, k, m);
        break;
      case 3:
        g = p() + (m ? t : Q("" + t));
        break;
      case 4:
        g = "<![CDATA[" + t + "]]\x3e";
        break;
      case 8:
        g = "\x3c!--" + t + "--\x3e";
        break;
      case 13:
        g = p() + "\x3c!--[" + t + "]>" + f(l, q, !0, m) + "<![endif]--\x3e";
        break;
      case 16:
        g = p() + "\x3c!--{" + t + "};" + f(l, q, !0, m) + "--\x3e";
        break;
      case 14:
        g = "\x3c!--[" + t + "]>\x3c!--\x3e";
        break;
      case 15:
        g = "\x3c!--<![endif]--\x3e";
        break;
      case 7:
        if (v) {
          if (k = ea(v, l, C, x), void 0 !== k && null !== k && "" !== k && (M(k) || k === +k || J(k))) {
            return -1;
          }
        } else {
          F("onInstruction is void!");
        }
        break;
      case 18:
        g = "</" + t + ">";
        break;
      case 17:
        var W = !0;
      case 1:
        n = l[1], G = 2;
      default:
        n = ia(n), C = n[1], x = n[2], n = n[0], G = l[G], "P" !== D || ca[n] ? D = "" : g = p(), A || (H = A = A || r[n] ? !0 : 0 < n.indexOf(":")), g += "<" + (A ? n : n.toLowerCase()), C && (g += " id=" + R(C, B, A || I)), x && (g += " class=" + R(x, B, A || I)), !J(G) && L(G) && (g += z(G)), g = (l = f(l, q, ba[n], m || da[n])) ? g + (">" + l) : W ? g + ">" : g + (A ? " />" : ">"), W && (D = ""), !l && y[n] ? D = "" : A && !l || aa[n] && (!k || "P" !== n) ? D = n : (g += "</" + (A ? n : n.toLowerCase()) + 
        ">", D = ""), H && (A = !1);
    }
    return g;
  }
  function f(l, C, g, x) {
    var k = [], m = l[0];
    var p = m === +m ? 2 : 1;
    1 === N(l) || 17 === m ? (m = l[p], p = !J(m) && L(m) ? p + 1 : p) : p = 11 === m ? 1 : 9 === m || 13 === m || 16 === m ? 2 : Infinity;
    m = -1;
    for (var q; p < l.length; ++p) {
      q = l[p], M(q) || q === +q ? k[++m] = d([3, q], l, C, p, !1, x) : J(q) && (q = d(q, l, C, p, g, x), -1 === q ? --p : k[++m] = q);
    }
    return k.join("");
  }
  function z(l) {
    var C = "", g, x;
    for (g in l) {
      var k = l[g];
      (x = 0 === g.indexOf(X)) && (g = g.substr(X.length));
      "className" === g && (g = "class");
      x && (v ? k = O(v, g, k, F) : F("onInstruction is void!"));
      if (!(null == k || w[g] && !1 === k || (C += " " + g, w[g] || !0 === k))) {
        if ("style" === g && L(k)) {
          x = void 0;
          var m = k, p = [], q = -1;
          for (x in m) {
            k = m[x];
            "0px" === k && (k = 0);
            for (var K = ++q, t, G = [], n = x.split(""), H = n.length; H;) {
              t = n[--H], "A" <= t && "Z" >= t && (t = "-" + t.toLowerCase()), G[H] = t;
            }
            p[K] = G.join("") + ":" + Q("" + k);
          }
          k = p.join(";").substr(1);
          if (!k) {
            continue;
          }
        }
        C += "=" + R(k, B, A || I);
      }
    }
    return C;
  }
  var v = b || null, u = c || null, F = "function" === typeof h ? h : function() {
  };
  b = e || {};
  var I = !0 === b.quotAlways, B = !0 === b.useSingleQuot, X = b.instructionAttrPrefix || ":", D, A = !1;
  if (J(a)) {
    return 7 === N(a) && (a = [11, a]), d(a, null, null, 0, !1, !1);
  }
}
;module.exports = Z;
Z.DOCUMENT_NODE = 9;
Z.DOCUMENT_FRAGMENT_NODE = 11;
Z.ELEMENT_NODE = 1;
Z.TEXT_NODE = 3;
Z.CDATA_SECTION = 4;
Z.PROCESSING_INSTRUCTION = 7;
Z.COMMENT_NODE = 8;
Z.COND_CMT_HIDE_LOWER = 13;
Z.COND_CMT_SHOW_LOWER_START = 14;
Z.COND_CMT_SHOW_LOWER_END = 15;
Z.NETSCAPE4_COND_CMT_HIDE_LOWER = 16;
Z.ELEMENT_START_TAG = 17;
Z.ELEMENT_END_TAG = 18;
Z.gulp = function(a, b, c, h) {
  const e = require("plugin-error");
  return require("through2").obj(function(d, f, z) {
    if (d.isNull()) {
      return z();
    }
    if (d.isStream()) {
      return this.emit("error", new e("json2html", "Streaming not supported")), z();
    }
    const v = "." + d.stem.split(".").pop();
    if (".json" === d.extname && [".html", ".htm", ".xhtml", ".php"].indexOf(v)) {
      try {
        const u = JSON.parse(d.contents.toString(f));
        if (J(u)) {
          const F = Z(u, a, b, c, h);
          d.stem = d.stem.substr(0, d.stem.length - v.length);
          d.extname = v;
          d.contents = Buffer.from(F);
        }
      } catch (u) {
        this.emit("error", new e("json2html", u));
      }
    }
    z(null, d);
  });
};

