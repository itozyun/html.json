var aa = {xml:!0, svg:!0, math:!0}, q = {async:!0, autofocus:!0, checked:!0, compact:!0, declare:!0, defer:!0, disabled:!0, draggable:!0, hidden:!0, ismap:!0, loop:!0, multiple:!0, nohref:!0, noresize:!0, noshade:!0, novalidate:!0, nowrap:!0, readonly:!0, required:!0, reversed:!0, scoped:!0, selected:!0}, da = {AREA:!0, BASE:!0, BASEFONT:!0, BR:!0, BGSOUND:!0, COL:!0, COMMAND:!0, FRAME:!0, HR:!0, IMG:!0, INPUT:!0, ISINDEX:!0, KEYGEN:!0, LINK:!0, META:!0, PARAM:!0, SOURCE:!0, TRACK:!0, EMBED:!0, WBR:!0, 
area:!0, base:!0, basefont:!0, br:!0, bgsound:!0, col:!0, command:!0, frame:!0, hr:!0, img:!0, input:!0, isindex:!0, keygen:!0, link:!0, meta:!0, param:!0, source:!0, track:!0, embed:!0, wbr:!0}, w = {CAPTION:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, 
VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DD:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, H2:!0, 
H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, 
INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DT:{ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, 
DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, P:{A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, 
RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, HTML:{HEAD:!0, BODY:!0}, HEAD:{TITLE:!0, BASE:!0, BGSOUND:!0, LINK:!0, META:!0, STYLE:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLETE:!0}, COLGROUP:{COL:!0}, OPTGROUP:{OPTION:!0}, 
OPTION:{}, TBODY:{TR:!0}, TR:{TH:!0, TD:!0}, RBC:{RB:!0, RP:!0, RT:!0}};
w.LI = w.TD = w.DD;
w.TH = w.DT;
w.RB = w.RP = w.RT = w.P;
w.TFOOT = w.THEAD = w.TBODY;
w.RTC = w.RBC;
var ea = {HTML:!0, HEAD:!0, BODY:!0, P:!0, DT:!0, DD:!0, LI:!0, OPTION:!0, TBODY:!0, THEAD:!0, TFOOT:!0, TD:!0, TH:!0, TR:!0, RB:!0, RBC:!0, RP:!0, RT:!0, RTC:!0, OPTGROUP:!0, CAPTION:!0, COLGROUP:!0}, fa = {A:!0, AUDIO:!0, DEL:!0, INS:!0, MAP:!0, NOSCRIPT:!0, VIDEO:!0}, ha = {H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, ADDRESS:!0, BLOCKQUOTE:!0, DIV:!0, DL:!0, FIELDSET:!0, FORM:!0, HR:!0, LEGEND:!0, MENU:!0, NOSCRIPT:!0, OL:!0, P:!0, PRE:!0, UL:!0, CENTER:!0, DIR:!0, NOFRAMES:!0, MARQUEE:!0}, ia = 
{SCRIPT:!0, STYLE:!0, TEXTAREA:!0, TITLE:!0, PLAINTEXT:!0, XMP:!0, script:!0, style:!0, textarea:!0, title:!0, plaintext:!0, xmp:!0};
function y(a) {
  return !(!a || a.pop !== [].pop);
}
function H(a) {
  return !(!a || "object" !== typeof a);
}
function J(a) {
  return "" + a === a;
}
function K(a) {
  return J(a) || a === +a;
}
function L(a) {
  if (K(a)) {
    a = 3;
  } else {
    if (y(a)) {
      if (J(a[0])) {
        a = 1;
      } else {
        var b = a[0];
        a = b === +b ? a[0] : -1;
      }
    } else {
      a = -1;
    }
  }
  return a;
}
function ja(a, b, e, g) {
  var c = b[1], d = b.slice(2), f;
  "function" === typeof a ? f = d.length ? a(c, d) : a(c) : a[c] && (f = d.length ? a[c].apply(null, d) : a[c]());
  void 0 !== f && null !== f && "" !== f && (K(f) ? e ? e.splice(g, 1, f) : (b.length = 0, b.push(3, b)) : y(f) && (11 === f[0] ? e ? (f.shift(), f.unshift(g, 1), e.splice.apply(e, f)) : (b.length = 0, b.push.apply(b, f)) : y(f[0]) ? e ? (f.unshift(g, 1), e.splice.apply(e, f)) : (b.length = 0, b.push(11), b.push.apply(b, f)) : e ? e.splice(g, 1, f) : (b.length = 0, b.push(11, f))));
  return f;
}
function M(a, b, e, g, c) {
  var d;
  if (y(e) && J(e[0])) {
    var f = e[0];
    e = e.slice(1);
    "function" === typeof a ? d = e.length ? a.call(c, f, e) : a.call(c, f) : a[f] && (d = e.length ? a[f].apply(c || a, e) : a[f].call(c || a));
  } else {
    J(e) && ("function" === typeof a ? d = a(e) : d = a[e]());
  }
  return y(d) ? M(a, b, d, g, c) : d;
}
function ka(a, b, e) {
  a = la(a);
  var g;
  P = a;
  b && (b.h ? b.h.push(a) : b.h = [a]);
  if (y(e)) {
    var c = 1 === a.m || 17 === a.m;
    b = 0;
    for (g = e.length; b < g; b += 2) {
      var d = e[b];
      var f = e[b + 1];
      if (d === +d) {
        if (d === a.m && !0 === f(a)) {
          break;
        }
      } else if ("*" === d) {
        if (!0 === f(a)) {
          break;
        }
      } else if (c && J(d) && d === a.D && !0 === f(a)) {
        break;
      }
    }
  } else {
    e(a);
  }
  return a;
}
function Q(a) {
  return a.split("&lt;").join("&amp;lt;").split("&gt;").join("&amp;gt;").split("<").join("&lt;").split(">").join("&gt;");
}
function R(a, b, e) {
  a = Q("" + a);
  var g = a.match('"'), c = a.match("'"), d = b ? "'" : '"';
  g && c ? a = b ? d + a.split("'").join("\\'") + d : d + a.split('"').join('\\"') + d : g ? a = "'" + a + "'" : c ? a = b ? d + a.split("'").join("\\'") + d : d + a + d : e || a.match(/[^0-9a-z\.\-]/g) || 72 < a.length ? a = d + a + d : "" === a && (a = d + d);
  return a;
}
function S(a) {
  var b = a[0], e = b === +b ? 2 : 1;
  1 === L(a) || 17 === b ? (a = a[e], e = !y(a) && H(a) ? e + 1 : e) : e = 11 === b ? 1 : 9 === b || 13 === b || 16 === b ? 2 : Infinity;
  return e;
}
function T(a) {
  var b = a.indexOf("#"), e = a.indexOf("."), g = "", c = "";
  b < e ? (g = a.split(".")[1], a = a.split(".")[0], 0 < b && (c = a.split("#")[1], a = a.split("#")[0])) : e < b && (c = a.split("#")[1], a = a.split("#")[0], 0 < e && (g = a.split(".")[1], a = a.split(".")[0]));
  return [a, c, g];
}
function la(a) {
  var b, e;
  ma(a, function(g, c, d, f) {
    function z(C, G, N) {
      if (b) {
        f + 1 < e.length && (e.length = f + 1);
        var n = e[e.length - 1];
        U <= V(n) ? (n.v = n.v || [], n.v.push([C, G, N]), C = null) : C = new W(n, n.h && n.h.length, C, G);
        y(g) && S(g) < g.length && (e[f + 1] = C);
      } else {
        b = new W(!0, 0, C, G), e = [b];
      }
    }
    if (K(g)) {
      z(3, g);
    } else {
      c = g[0];
      d = g[1];
      var v = 1, p = c, F;
      switch(c) {
        case 9:
        case 13:
        case 16:
          z(c, d);
          break;
        case 11:
          z(c);
          break;
        case 3:
        case 4:
        case 8:
        case 14:
        case 18:
          z(c, d);
          break;
        case 15:
          z(c);
          break;
        case 7:
          v = [];
          p = 2;
          for (F = g.length; p < F; ++p) {
            v[p - 2] = g[p];
          }
          z(c, d, F - 2 ? v : null);
          break;
        case 1:
        case 17:
          p = d, v = 2;
        default:
          J(p) && z(1 === v ? 1 : c, p, g[v]);
      }
    }
    return X;
  });
  return b;
}
var na = -1, oa = 1, X = Infinity, Y = Infinity;
function ma(a, b) {
  var e = a, g = S(a), c = 0, d = b(a, null, -1, 0);
  a = [-1, a, g];
  if (d !== X && d !== Y && 0 < e.length - g) {
    do {
      d = ++a[c];
      var f = e[d + g];
      if (void 0 === f) {
        a.length = c, c -= 3, e = a[c + 1], g = a[c + 2];
      } else {
        d = b(f, e, d + g, c / 3);
        if (d === X) {
          break;
        }
        d !== Y && (d <= na ? a[c] += d : (oa <= d && (a[c] += d), 0 < f.length - S(f) && (c += 3, a[c] = -1, a[c + 1] = e = f, a[c + 2] = g = S(f))));
      }
    } while (0 <= c);
  }
}
;function W(a, b, e, g) {
  if (a === !!a) {
    var c = null;
    this.l = a;
  } else {
    c = a, this.l = c.l;
  }
  this.j = c;
  this.m = e;
  c && (c.h || (c.h = []), a = c.h, 0 <= b && b < a.length ? a.splice(b, 0, this) : a.push(this));
  switch(e) {
    case 1:
    case 17:
      b = T(g), g = b[0];
    case 18:
      this.D = g;
  }
}
var P = null;
function V(a) {
  return a.l ? P === a ? a.C ? pa : a.F ? U : qa : P.j === a ? ra : sa : ta;
}
W.prototype.remove = function() {
  if (U <= V(this)) {
    return this.C = !0, null;
  }
  var a = this.j ? this.j.h.indexOf(this) : -1;
  0 <= a && (this.j.h.splice(a, 1), this.j = null);
};
W.prototype.wrap = function(a, b, e) {
  if (this.l) {
    this.o = this.o || [], this.o.push([a, b, e]), a = null;
  } else {
    if (this.j) {
      var g = (e = this.j) ? this.j.h.indexOf(this) : -1;
      a = new W(e, g, a, b);
    } else {
      a = null;
    }
  }
  ua(a, 0, [this]);
  return a;
};
function ua(a, b, e) {
  var g = a.h = a.h || [], c = g.length, d = e.length;
  for (b = b < c ? b : c; d;) {
    c = e[--d], 11 === c.m ? c.h && c.h.length && ua(a, b, c.h) : (c.remove(), g.splice(b, 0, c), c.j = a);
  }
}
var ta = 0, sa = 1, qa = 2, U = 3, pa = 4, ra = 5;
function Z(a, b, e, g, c) {
  function d(l, B, h, x, k, r) {
    function D() {
      var ba = "";
      n && (ba = "</" + (A ? n : n.toLowerCase()) + ">", n = "");
      return ba;
    }
    var t = p ? ka(l, h, p) : null;
    h = "";
    var O = l[0], u = l[1], E = 1, m = O, I;
    switch(O) {
      case 9:
        h = u + f(l, t, !1, r);
        break;
      case 11:
        h = f(l, t, k, r);
        break;
      case 3:
        h = D() + (r ? u : Q("" + u));
        break;
      case 4:
        h = "<![CDATA[" + Q("" + u) + "]]\x3e";
        break;
      case 8:
        h = "\x3c!--" + Q("" + u) + "--\x3e";
        break;
      case 13:
        h = D() + "\x3c!--[" + u + "]>" + f(l, t, !0, r) + "<![endif]--\x3e";
        break;
      case 16:
        h = D() + "\x3c!--{" + u + "};" + f(l, t, !0, r) + "--\x3e";
        break;
      case 14:
        h = "\x3c!--[" + u + "]>\x3c!--\x3e";
        break;
      case 15:
        h = "\x3c!--<![endif]--\x3e";
        break;
      case 7:
        if (v) {
          if (k = ja(v, l, B, x), void 0 !== k && null !== k && "" !== k && (K(k) || y(k))) {
            return -1;
          }
        } else {
          F("onInstruction is void!");
        }
        break;
      case 18:
        h = "</" + u + ">";
        break;
      case 17:
        var ca = !0;
      case 1:
        m = l[1], E = 2;
      default:
        m = T(m), B = m[1], x = m[2], m = m[0], E = l[E], "P" !== n || ha[m] ? n = "" : h = D(), A || (I = A = A || aa[m] ? !0 : 0 < m.indexOf(":")), h += "<" + (A ? m : m.toLowerCase()), B && (h += " id=" + R(B, G, A || C)), x && (h += " class=" + R(x, G, A || C)), !y(E) && H(E) && (h += z(E)), h = (l = f(l, t, fa[m], r || ia[m])) ? h + (">" + l) : ca ? h + ">" : h + (A ? " />" : ">"), ca && (n = ""), !l && da[m] ? n = "" : A && !l || ea[m] && (!k || "P" !== m) ? n = m : (h += "</" + (A ? m : m.toLowerCase()) + 
        ">", n = ""), I && (A = !1);
    }
    return h;
  }
  function f(l, B, h, x) {
    for (var k = [], r = S(l), D = -1, t; r < l.length; ++r) {
      t = l[r], K(t) ? k[++D] = d([3, t], l, B, r, !1, x) : y(t) && (t = d(t, l, B, r, h, x), -1 === t ? --r : k[++D] = t);
    }
    return k.join("");
  }
  function z(l) {
    var B = "", h, x;
    for (h in l) {
      var k = l[h];
      (x = 0 === h.indexOf(N)) && (h = h.substr(N.length));
      "className" === h && (h = "class");
      x && v && (k = M(v, h, k, F));
      if (!(null == k || q[h] && !1 === k || (B += " " + h, q[h] || !0 === k))) {
        if ("style" === h && H(k)) {
          x = void 0;
          var r = k, D = [], t = -1;
          for (x in r) {
            k = r[x];
            "0px" === k && (k = 0);
            for (var O = ++t, u, E = [], m = x.split(""), I = m.length; I;) {
              u = m[--I], "A" <= u && "Z" >= u && (u = "-" + u.toLowerCase()), E[I] = u;
            }
            D[O] = E.join("") + ":" + Q("" + k);
          }
          k = D.join(";").substr(1);
          if (!k) {
            continue;
          }
        }
        B += "=" + R(k, G, A || C);
      }
    }
    return B;
  }
  var v = b || null, p = e || null, F = "function" === typeof g ? g : function() {
  };
  b = c || {};
  var C = !0 === b.quotAlways, G = !0 === b.useSingleQuot, N = b.instructionAttrPrefix || ":", n, A = !1;
  if (y(a)) {
    return 7 === L(a) && (a = [11, a]), d(a, null, null, 0, !1, !1);
  }
}
;module.exports = Z;
Z.DOCUMENT_NODE = 9;
Z.DOCUMENT_FRAGMENT_NODE = 11;
Z.ELEMENT_NODE = 1;
Z.TEXT_NODE = 3;
Z.CDATA_SECTION = 4;
Z.PROCESSING_INSTRUCTION = 7;
Z.COMMENT_NODE = 8;
Z.COND_CMT_HIDE_LOWER = 13;
Z.COND_CMT_SHOW_LOWER_START = 14;
Z.COND_CMT_SHOW_LOWER_END = 15;
Z.NETSCAPE4_COND_CMT_HIDE_LOWER = 16;
Z.ELEMENT_START_TAG = 17;
Z.ELEMENT_END_TAG = 18;
Z.gulp = function(a, b, e, g) {
  const c = require("plugin-error");
  return require("through2").obj(function(d, f, z) {
    if (d.isNull()) {
      return z();
    }
    if (d.isStream()) {
      return this.emit("error", new c("json2html", "Streaming not supported")), z();
    }
    const v = "." + d.stem.split(".").pop();
    if (".json" === d.extname && [".html", ".htm", ".xhtml", ".php"].indexOf(v)) {
      try {
        const p = JSON.parse(d.contents.toString(f));
        if (y(p)) {
          const F = Z(p, a, b, e, g);
          d.stem = d.stem.substr(0, d.stem.length - v.length);
          d.extname = v;
          d.contents = Buffer.from(F);
        }
      } catch (p) {
        this.emit("error", new c("json2html", p));
      }
    }
    z(null, d);
  });
};

