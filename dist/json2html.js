var aa = {xml:!0, svg:!0, math:!0}, ba = {async:!0, autofocus:!0, checked:!0, compact:!0, declare:!0, defer:!0, disabled:!0, draggable:!0, hidden:!0, ismap:!0, loop:!0, multiple:!0, nohref:!0, noresize:!0, noshade:!0, novalidate:!0, nowrap:!0, readonly:!0, required:!0, reversed:!0, scoped:!0, selected:!0}, ca = {AREA:!0, BASE:!0, BASEFONT:!0, BR:!0, BGSOUND:!0, COL:!0, COMMAND:!0, FRAME:!0, HR:!0, IMG:!0, INPUT:!0, ISINDEX:!0, KEYGEN:!0, LINK:!0, META:!0, PARAM:!0, SOURCE:!0, TRACK:!0, EMBED:!0, 
WBR:!0, area:!0, base:!0, basefont:!0, br:!0, bgsound:!0, col:!0, command:!0, frame:!0, hr:!0, img:!0, input:!0, isindex:!0, keygen:!0, link:!0, meta:!0, param:!0, source:!0, track:!0, embed:!0, wbr:!0}, da = {SCRIPT:!0, STYLE:!0, TEXTAREA:!0, TITLE:!0, PLAINTEXT:!0, XMP:!0, LISTING:!0, script:!0, style:!0, textarea:!0, title:!0, plaintext:!0, xmp:!0, listing:!0}, ea = {TEXTAREA:!0, TITLE:!0, LISTING:!0, textarea:!0, title:!0, listing:!0}, x = {CAPTION:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, 
H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, FORM:!0, LABEL:!0, 
INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DD:{ARTICLE:!0, SECTION:!0, NAV:!0, ASIDE:!0, H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, HEADER:!0, FOOTER:!0, ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, 
KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, DT:{ADDRESS:!0, P:!0, HR:!0, PRE:!0, BLOCKQUOTE:!0, OL:!0, UL:!0, 
DL:!0, FIGURE:!0, DIV:!0, A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, TABLE:!0, FORM:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, PROGRESS:!0, METER:!0, FIELDSET:!0, 
DETAILS:!0, DIALOG:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, P:{A:!0, EM:!0, STRONG:!0, SMALL:!0, S:!0, CITE:!0, Q:!0, DFN:!0, ABBR:!0, DATA:!0, TIME:!0, CODE:!0, VAR:!0, SAMP:!0, KBD:!0, SUB:!0, SUP:!0, I:!0, B:!0, U:!0, MARK:!0, RUBY:!0, BDI:!0, BDO:!0, SPAN:!0, BR:!0, WBR:!0, INS:!0, DEL:!0, PICTURE:!0, IMG:!0, IFRAME:!0, EMBED:!0, OBJECT:!0, VIDEO:!0, AUDIO:!0, MAP:!0, AREA:!0, math:!0, svg:!0, LABEL:!0, INPUT:!0, BUTTON:!0, SELECT:!0, DATALIST:!0, TEXTAREA:!0, KEYGEN:!0, OUTPUT:!0, 
PROGRESS:!0, METER:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0, CANVAS:!0}, HTML:{HEAD:!0, BODY:!0, FRAMESET:!0}, HEAD:{TITLE:!0, BASE:!0, BGSOUND:!0, LINK:!0, META:!0, STYLE:!0, SCRIPT:!0, NOSCRIPT:!0, TEMPLATE:!0}, COLGROUP:{COL:!0}, OPTGROUP:{OPTION:!0}, OPTION:{}, TBODY:{TR:!0}, TR:{TH:!0, TD:!0}, RBC:{RB:!0, RP:!0, RT:!0}};
x.LI = x.TD = x.DD;
x.TH = x.DT;
x.RB = x.RP = x.RT = x.P;
x.TFOOT = x.THEAD = x.TBODY;
x.RTC = x.RBC;
function y(a) {
  return a.split("&lt;").join("&amp;lt;").split("&gt;").join("&amp;gt;").split("<").join("&lt;").split(">").join("&gt;");
}
;function A(a) {
  return a === "" + a;
}
function G(a) {
  return !!a && "object" === typeof a;
}
function I(a) {
  return !!a && a.constructor === Array;
}
;function fa(a) {
  function d(b) {
    var f = b, c;
    if (I(b)) {
      f = [];
      var e = 0;
      for (c = b.length; e < c; ++e) {
        f[e] = d(b[e]);
      }
    } else if (G(b)) {
      for (e in f = {}, b) {
        f[e] = d(b[e]);
      }
    }
    return f;
  }
  return d(a);
}
;function J(a, d, b) {
  var f = a, c = K(f), e = 0, g = d(a, null, -1, e / 3), k = [-1, a, c];
  if (Infinity !== g && -Infinity !== g) {
    if (0 < f.length - c) {
      do {
        var p = ++k[e];
        var n = f[p + c];
        if (null != n) {
          g = d(n, f, p + c, e / 3 + 1);
          if (Infinity === g) {
            return;
          }
          if (-Infinity !== g) {
            if (-1 >= g) {
              k[e] += g;
            } else {
              if (1 <= g && (k[e] += g), K(n) < n.length) {
                e += 3, k[e] = -1, k[e + 1] = f = n, k[e + 2] = c = K(n);
              } else if (b && f) {
                g = b(n, f, p + c, e / 3 + 1);
                if (Infinity === g) {
                  return;
                }
                -Infinity !== g && (-1 >= g || 1 <= g) && (k[e] += g);
              }
            }
          }
        } else {
          if (k.length = e, e -= 3, f = k[e + 1], c = k[e + 2], b && f) {
            p = k[e] + c;
            g = b(f[p], f, p, e / 3 + 1);
            if (Infinity === g) {
              return;
            }
            -Infinity !== g && (-1 >= g || 1 <= g) && (k[e] += g);
          }
        }
      } while (0 <= e);
    }
    b && b(a, null, -1, 0);
  }
}
;function M(a, d, b, f) {
  if (!!a === a) {
    var c = null;
    this.l = a;
  } else {
    c = a, this.l = c.l;
  }
  this.j = c;
  this.m = b;
  c && (c.h || (c.h = []), a = c.h, 0 <= d && d < a.length ? a.splice(d, 0, this) : a.push(this));
  switch(b) {
    case 1:
    case 17:
      d = O(f), f = d[0];
    case 18:
      this.F = f;
  }
}
var P = null;
function Q(a) {
  return a.l ? P === a ? a.D ? ha : a.G ? R : ia : P.j === a ? ja : ka : la;
}
M.prototype.remove = function() {
  if (R <= Q(this)) {
    return this.D = !0, null;
  }
  var a = this.j ? this.j.h.indexOf(this) : -1;
  0 <= a && (this.j.h.splice(a, 1), this.j = null);
};
M.prototype.wrap = function(a, d, b) {
  if (this.l) {
    this.o = this.o || [], this.o.push([a, d, b]), a = null;
  } else {
    if (this.j) {
      var f = (b = this.j) ? this.j.h.indexOf(this) : -1;
      a = new M(b, f, a, d);
    } else {
      a = null;
    }
  }
  U(a, 0, [this]);
  return a;
};
function U(a, d, b) {
  var f = a.h = a.h || [], c = f.length, e = b.length;
  for (d = d < c ? d : c; e;) {
    c = b[--e], 11 === c.m ? c.h && c.h.length && U(a, d, c.h) : (c.remove(), f.splice(d, 0, c), c.j = a);
  }
}
var la = 0, ka = 1, ia = 2, R = 3, ha = 4, ja = 5;
var ma = {HTML:!0, HEAD:!0, BODY:!0, P:!0, DT:!0, DD:!0, LI:!0, OPTION:!0, TBODY:!0, THEAD:!0, TFOOT:!0, TD:!0, TH:!0, TR:!0, RB:!0, RBC:!0, RP:!0, RT:!0, RTC:!0, OPTGROUP:!0, CAPTION:!0, COLGROUP:!0}, na = {A:!0, AUDIO:!0, DEL:!0, INS:!0, MAP:!0, NOSCRIPT:!0, VIDEO:!0}, oa = {H1:!0, H2:!0, H3:!0, H4:!0, H5:!0, H6:!0, ADDRESS:!0, BLOCKQUOTE:!0, DIV:!0, DL:!0, FIELDSET:!0, FORM:!0, HR:!0, LEGEND:!0, MENU:!0, NOSCRIPT:!0, OL:!0, P:!0, PRE:!0, UL:!0, CENTER:!0, DIR:!0, NOFRAMES:!0, MARQUEE:!0};
function V(a) {
  if (A(a) || a === +a) {
    a = 3;
  } else {
    if (I(a)) {
      if (A(a[0])) {
        a = 1;
      } else {
        var d = a[0];
        a = d === +d ? a[0] : -1;
      }
    } else {
      a = -1;
    }
  }
  return a;
}
function pa(a, d, b) {
  var f = d[1];
  d = d.slice(2);
  var c;
  a && a.constructor === Function ? c = d.length ? a.call(b, f, d) : a.call(b, f) : a[f] && (c = d.length ? a[f].apply(b || a, d) : a[f].call(b || a));
  (c = fa(c)) && I(c[0]) && c.unshift(11);
  return c;
}
function qa(a, d, b) {
  11 === b[0] ? (b.shift(), b.unshift(d, 1), a.splice.apply(a, b)) : a.splice(d, 1, b);
}
function W(a, d, b, f, c) {
  var e;
  if (I(b) && A(b[0])) {
    var g = b[0];
    b = b.slice(1);
    a && a.constructor === Function ? e = b.length ? a.call(c, g, b) : a.call(c, g) : a[g] && (e = b.length ? a[g].apply(c || a, b) : a[g].call(c || a));
  } else {
    A(b) && (a && a.constructor === Function ? e = a.call(c, b) : a[b] && (e = a[b].call(c || a)));
  }
  I(e) && (a = W(a, d, e, f, c), void 0 !== a && (e = a));
  return e;
}
function ra(a, d, b) {
  a = sa(a);
  var f;
  P = a;
  d && (d.h ? d.h.push(a) : d.h = [a]);
  if (I(b)) {
    for (d = 0, f = b.length; d < f; d += 2) {
      var c = b[d];
      var e = b[d + 1];
      if (c === +c) {
        if (c === a.m && !0 === e(a)) {
          break;
        }
      } else if ("*" === c) {
        if (!0 === e(a)) {
          break;
        }
      } else if (A(c) && c === a.F && !0 === e(a)) {
        break;
      }
    }
  } else {
    b(a);
  }
  return a;
}
function K(a) {
  var d = a[0], b = V(a);
  return 1 === b || 17 === b ? (d = d === +d ? 2 : 1, a = a[d], !I(a) && G(a) ? d + 1 : d) : 11 === d ? 1 : 9 === d || 13 === d || 16 === d ? 2 : Infinity;
}
function O(a) {
  var d = a.indexOf("#"), b = a.indexOf("."), f = "", c = "";
  d < b ? (f = a.split(".")[1], a = a.split(".")[0], 0 < d && (c = a.split("#")[1], a = a.split("#")[0])) : b < d && (c = a.split("#")[1], a = a.split("#")[0], 0 < b && (f = a.split(".")[1], a = a.split(".")[0]));
  return [a, c, f];
}
function ta(a) {
  var d = [], b = -1, f;
  for (f in a) {
    var c = a[f];
    "0px" === c && (c = 0);
    for (var e = ++b, g, k = [], p = f.split(""), n = p.length; n;) {
      g = p[--n], "A" <= g && "Z" >= g && (g = "-" + g.toLowerCase()), k[n] = g;
    }
    g = k.join("");
    d[e] = g + ":" + c;
  }
  return d.join(";");
}
function sa(a) {
  var d, b;
  J(a, function(f, c, e, g) {
    function k(q, z, h) {
      if (d) {
        g < b.length && (b.length = g);
        var l = b[b.length - 1];
        R <= Q(l) ? (l.v = l.v || [], l.v.push([q, z, h]), q = null) : q = new M(l, l.h && l.h.length, q, z);
        K(f) < f.length && (b[g] = q);
      } else {
        d = new M(!0, 0, q, z), b = [d];
      }
    }
    if (A(f) || f === +f) {
      k(3, f);
    } else {
      c = f[0];
      e = f[1];
      var p = 1, n = c, H;
      switch(c) {
        case 9:
        case 13:
        case 16:
          k(c, e);
          break;
        case 11:
          k(c);
          break;
        case 3:
        case 4:
        case 8:
        case 14:
        case 18:
          k(c, e);
          break;
        case 15:
          k(c);
          break;
        case 7:
          p = [];
          n = 2;
          for (H = f.length; n < H; ++n) {
            p[n - 2] = f[n];
          }
          k(c, e, H - 2 ? p : null);
          break;
        case 1:
        case 17:
          n = e, p = 2;
        default:
          A(n) && k(1 === p ? 1 : c, n, f[p]);
      }
    }
    return Infinity;
  });
  return d;
}
;function X(a, d, b, f, c) {
  9 !== a[0] && 11 !== a[0] && (a = [11, a]);
  var e = [], g = -1;
  ua({h:function(k) {
    e[++g] = k;
  }}, function(k, p) {
    J(a, k, p);
  }, d, b, f, c);
  return e.join("");
}
function ua(a, d, b, f, c, e) {
  function g() {
    var h = "";
    z && (h = "</" + z.toLowerCase() + ">", z = "");
    return h;
  }
  function k(h, l, v) {
    var r = h.match('"'), D = h.match("'"), t = l ? "'" : '"';
    r && D ? h = l ? t + h.split("'").join("\\'") + t : t + h.split('"').join('\\"') + t : r ? h = "'" + h + "'" : D ? h = l ? t + h.split("'").join("\\'") + t : t + h + t : v || h.match(/[^0-9a-z\.\-]/g) || 72 < h.length ? h = t + h + t : "" === h && (h = t + t);
    return h;
  }
  e = e || {};
  var p = !0 === e.useQuoteAlways, n = !0 === e.useSingleQuote, H = e.instructionAttrPrefix || ":", q = [!1, null, !1, !1, !1], z;
  d(function(h, l, v, r, D, t) {
    function L(Y) {
      m[++u] = g() + (N ? Y : y("" + Y));
    }
    var m = [], u = -1;
    D = !1;
    I(h) && (D = K(h) < h.length);
    var E = q[5 * r], S = q[5 * r + 1], T = q[5 * r + 2], N = q[5 * r + 3];
    S = f ? ra(h, S, f) : null;
    var w = h[0], B = h[1], Z = 1, C;
    switch(V(h)) {
      case 9:
        m[++u] = B;
        break;
      case 3:
        I(h) || (B = h);
        L(B);
        break;
      case 4:
        m[++u] = "<![CDATA[" + y("" + B) + "]]\x3e";
        break;
      case 8:
        m[++u] = "\x3c!--" + y("" + B) + "--\x3e";
        break;
      case 13:
        m[++u] = g() + "\x3c!--[" + B + "]>";
        break;
      case 16:
        m[++u] = g() + "\x3c!--{" + B + "};";
        break;
      case 14:
        m[++u] = "\x3c!--[" + B + "]>\x3c!--\x3e";
        break;
      case 15:
        m[++u] = "\x3c!--<![endif]--\x3e";
        break;
      case 7:
        if (b) {
          var F = pa(b, h, t);
          if (t = I(F)) {
            return qa(l, v, F), -1;
          }
          (A(F) || F === +F) && "" !== F && L(F);
        }
        break;
      case 18:
        m[++u] = "</" + (E ? B : B.toLowerCase()) + ">";
        break;
      case 17:
        F = !0;
      case 1:
        w === +w && (w = B, Z = 2);
        w = O(w);
        l = w[1];
        v = w[2];
        w = w[0];
        h = h[Z];
        "P" !== z || oa[w] ? z = "" : m[++u] = g();
        E = E || (E || aa[w] ? !0 : 0 < w.indexOf(":"));
        T = T || !!na[w];
        N = N || da[w] && !ea[w];
        m[++u] = "<" + (E ? w : w.toLowerCase());
        l && (m[++u] = " id=" + k(l, n, E || p));
        v && (m[++u] = " class=" + k(v, n, E || p));
        if (!I(h) && G(h)) {
          for (C in h) {
            if (l = h[C], (v = 0 === C.indexOf(H)) && (C = C.substr(H.length)), "className" === C && (C = "class"), v && b && (l = W(b, C, l, c, t)), null != l && (v = ba[C], !v || !1 !== l)) {
              if (m[++u] = " " + C, !v && !0 !== l) {
                if ("style" === C && G(l)) {
                  if (l = y(ta(l)), !l) {
                    continue;
                  }
                } else {
                  l = y("" + l);
                }
                m[++u] = "=" + k(l, n, E || p);
              }
            }
          }
        }
        !E || D || F ? m[++u] = ">" : m[++u] = " />";
    }
    q[5 * r + 5] = E;
    q[5 * r + 6] = S;
    q[5 * r + 7] = T;
    q[5 * r + 8] = N;
    q[5 * r + 9] = D;
    -1 !== u && a.h(m.join(""));
  }, function(h, l, v, r) {
    l = [];
    v = -1;
    var D = q[5 * r + 5], t = q[5 * r + 7], L = q[5 * r + 9], m = h[0];
    5 * r + 5 < q.length && (q.length = 5 * r + 5);
    switch(V(h)) {
      case 13:
        l[++v] = g() + "<![endif]--\x3e";
        break;
      case 16:
        l[++v] = g() + "--\x3e";
        break;
      case 17:
        z = "";
        break;
      case 1:
        m === +m && (m = h[1]), m = O(m)[0], !L && ca[m] ? z = "" : D && !L || ma[m] && (!t || "P" !== m) ? z = m : (l[++v] = "</" + (D ? m : m.toLowerCase()) + ">", z = "");
    }
    -1 !== v && a.h(l.join(""));
    0 === r && (a = null);
  });
  d = null;
}
;module.exports = X;
X.DOCUMENT_NODE = 9;
X.DOCUMENT_FRAGMENT_NODE = 11;
X.ELEMENT_NODE = 1;
X.TEXT_NODE = 3;
X.CDATA_SECTION = 4;
X.PROCESSING_INSTRUCTION = 7;
X.COMMENT_NODE = 8;
X.COND_CMT_HIDE_LOWER = 13;
X.COND_CMT_SHOW_LOWER_START = 14;
X.COND_CMT_SHOW_LOWER_END = 15;
X.NETSCAPE4_COND_CMT_HIDE_LOWER = 16;
X.ELEMENT_START_TAG = 17;
X.ELEMENT_END_TAG = 18;
X.gulp = function(a, d, b, f) {
  const c = require("plugin-error");
  return require("through2").obj(function(e, g, k) {
    if (e.isNull()) {
      return k();
    }
    if (e.isStream()) {
      return this.emit("error", new c("json2html", "Streaming not supported")), k();
    }
    const p = "." + e.stem.split(".").pop();
    if (".json" === e.extname && [".html", ".htm", ".xhtml", ".php"].indexOf(p)) {
      try {
        const n = JSON.parse(e.contents.toString(g));
        if (I(n)) {
          const H = X(n, a, d, b, f);
          e.stem = e.stem.substr(0, e.stem.length - p.length);
          e.extname = p;
          e.contents = Buffer.from(H);
        }
      } catch (n) {
        this.emit("error", new c("json2html", n));
      }
    }
    k(null, e);
  });
};

